## Get all the vulnerabilities on ACTIVE devices
```
DeviceInfo
    //Les postes de travail actif et onboardé sont les seuls à être pris en compte
    | where OnboardingStatus=="Onboarded" and SensorHealthState =="Active" 
    | summarize arg_max(Timestamp, *) by DeviceId
    | join(
        DeviceTvmSoftwareVulnerabilities
                    | where VulnerabilitySeverityLevel == "Critical"
        ) on DeviceId
    | project DeviceName, OSPlatform, CveId, SoftwareVendor, SoftwareName, SoftwareVersion, VulnerabilitySeverityLevel, Timestamp, DeviceId, ClientVersion, OSBuild, LoggedOnUsers, RegistryDeviceTag, OSVersion, OnboardingStatus, DeviceType, OSDistribution, OSVersionInfo, SensorHealthState
```

## Get the vulnerabilities and the number of times they appear in the parc
```
DeviceInfo
    //Les postes de travail actif et onboardé sont les seuls à être pris en compte
    | where OnboardingStatus=="Onboarded" and SensorHealthState =="Active" 
    | summarize arg_max(Timestamp, *) by DeviceId
    | join(
        DeviceTvmSoftwareVulnerabilities
                    | where VulnerabilitySeverityLevel == "Critical"
        ) on DeviceId
    | project CveId, SoftwareVendor, SoftwareName, SoftwareVersion, VulnerabilitySeverityLevel
    | summarize Count=count() by CveId, SoftwareVendor, VulnerabilitySeverityLevel
    | sort by Count desc 
```
